* Checking for deprecated package usage... OK
* Checking for remote package usage... OK
* Checking for 'LazyData: true' usage...
* NOTE: 'LazyData:' in the 'DESCRIPTION' should be set to false or removed
* Checking version number... OK
* Checking version number validity... OK
* Checking R version dependency...
* NOTE: Update R version dependency from 4.1.0 to 4.4.0.
* Checking package size... OK
* Checking individual file sizes... OK
* Checking biocViews... OK
* Checking that biocViews are present... OK
* Checking package type based on biocViews... OK
* Checking for non-trivial biocViews... OK
* Checking that biocViews come from the same category... OK
* Checking biocViews validity... OK
* Checking for recommended biocViews...
* NOTE: Consider adding these automatically suggested biocViews: GeneSetEnrichment
* Checking build system compatibility... OK
* Checking for blank lines in DESCRIPTION... OK
* Checking if DESCRIPTION is well formatted... OK
* Checking for proper Description: field... OK
* Checking for whitespace in DESCRIPTION field names... OK
* Checking that Package field matches directory/tarball name... OK
* Checking for Version: field... OK
* Checking for valid maintainer...
* NOTE: Consider adding the maintainer's ORCID iD in 'Authors@R' with 'comment=c(ORCID="...")'
* Checking License: for restrictive use... OK
* Checking for recommended DESCRIPTION fields...
* NOTE: Provide 'URL', 'BugReports' field(s) in DESCRIPTION
* Checking for Bioconductor software dependencies... OK
* Checking for pinned package versions in DESCRIPTION... OK
* Checking .Rbuildignore... OK
* Checking for stray BiocCheck output folders... OK
* Checking for inst/doc folders... OK
* Checking vignette directory...
* WARNING: Evaluate more vignette chunks.
* Checking package installation calls in R code... OK
* Checking for library/require of DESandbox... OK
* Checking coding practice...
* NOTE:  Avoid sapply(); use vapply()
Found in files:
R/comparison.R (line 83, column 28)
R/comparison.R (line 84, column 9)
R/comparison.R (line 92, column 21)
R/comparison.R (line 93, column 21)
R/comparison.R (line 98, column 23)
R/comparison.R (line 213, column 23)
R/comparison.R (line 214, column 11)
R/comparison.R (line 300, column 22)
R/de_analysis.R (line 372, column 23)
R/enrichment.R (line 288, column 45)
R/enrichment.R (line 314, column 20)
R/enrichment.R (line 317, column 22)
R/enrichment.R (line 341, column 21)
R/enrichment.R (line 342, column 9)
* NOTE:  Avoid 1:...; use seq_len() or seq_along()
Found in files:
comparison.R (line 53, column 13)
comparison.R (line 54, column 15)
comparison.R (line 67, column 13)
comparison.R (line 68, column 15)
comparison.R (line 184, column 13)
comparison.R (line 217, column 32)
comparison.R (line 220, column 52)
visualization.R (line 489, column 50)
visualization.R (line 595, column 20)
visualization.R (line 620, column 57)
visualization.R (line 684, column 20)
visualization.R (line 743, column 57)
* Checking parsed R code in R directory, examples, vignettes... OK
* Checking function lengths...
* NOTE: The recommended function length is 50 lines or less. There are 17 functions greater than 50 lines.
The longest 5 functions are:
plot_volcano() (R/visualization.R): 191 lines
run_enrichment() (R/enrichment.R): 157 lines
compare_methods() (R/comparison.R): 117 lines
export_results() (R/result_processing.R): 117 lines
create_venn_3way() (R/visualization.R): 108 lines
* Checking man page documentation...
* WARNING: Empty or missing \value sections found in man page(s).
Found in files:
man/compute_pathway_overlap.Rd
man/utils.Rd
man/visualization.Rd
* ERROR: At least 80% of man pages documenting exported objects must have runnable examples.
The following pages do not:
cache_analysis.Rd
compare_enrichment.Rd
compare_methods.Rd
compute_overlap.Rd
create_consensus_list.Rd
export_results.Rd
filter_results.Rd
generate_analysis_hash.Rd
load_cached_analysis.Rd
plot_de_counts.Rd
plot_venn_de.Rd
plot_volcano.Rd
run_all_methods.Rd
run_deseq2.Rd
run_edger.Rd
run_enrichment_from_de.Rd
run_enrichment.Rd
run_limma_voom.Rd
standardize_results.Rd
* NOTE: Usage of dontrun{} / donttest{} tags found in man page examples. 9% of man pages use at least one of these tags.
Found in files:
plot_de_counts.Rd
plot_venn_de.Rd
plot_volcano.Rd
* NOTE: Use donttest{} instead of dontrun{}.
Found in files:
plot_de_counts.Rd
plot_venn_de.Rd
plot_volcano.Rd
* Checking package NEWS... OK
* Checking unit tests... OK
* Checking skip_on_bioc() in tests... OK
* Checking formatting of DESCRIPTION, NAMESPACE, man pages, R source, and vignette source...
* NOTE: Consider shorter lines; 98 lines (3%) are > 80 characters long.
First few lines:
R/caching.R#L3 #' Saves analysis results with metadata  ...
R/caching.R#L6 #' @param cache_dir Directory to store c ...
R/caching.R#L33     cache_name <- paste0("desandbox_", t ...
R/caching.R#L70 #' @param check_version Whether to check ...
R/caching.R#L88     warning("Cache file may not be a val ...
R/caching.R#L107           "Cache was created with DESand ...
R/caching.R#L122 #' @param cache_dir Directory containing ...
R/caching.R#L164 #' @param cache_dir Directory containing ...
R/caching.R#L165 #' @param older_than Remove files older  ...
R/comparison.R#L6 #' @param padj_threshold Adjusted p-valu ...
R/comparison.R#L70         intersection <- length(intersect ...
R/comparison.R#L189       overlap_genes <- intersect(sig_gen ...
R/comparison.R#L190       unique_to_1 <- setdiff(sig_genes_l ...
R/comparison.R#L191       unique_to_2 <- setdiff(sig_genes_l ...
R/comparison.R#L203         jaccard_index = length(overlap_g ...
R/comparison.R#L204                                          ...
R/comparison.R#L226   overlap_summary <- do.call(rbind, lapp ...
R/comparison.R#L262 #' @param aggregate_lfc How to aggregate ...
R/comparison.R#L324       agg_lfc <- min(abs(lfc_values), na ...
R/comparison.R#L326       agg_lfc <- max(abs(lfc_values), na ...
R/data_validation.R#L5 #' @param counts A numeric matrix or dat ...
R/data_validation.R#L7 #' @param min_samples Minimum number of  ...
R/data_validation.R#L40     stop("counts contains negative value ...
R/data_validation.R#L69     warning("Very few genes remaining af ...
R/data_validation.R#L92 #' Validates that sample metadata is pro ...
R/data_validation.R#L96 #' @param condition_column Name of the c ...
R/data_validation.R#L129     stop(sprintf("Condition column '%s'  ...
R/data_validation.R#L147     warning("Some conditions have fewer  ...
R/data_validation.R#L194 #' Creates a standardized S4 object cont ...
R/data_validation.R#L229     meta_validation <- validate_metadata ...
R/de_analysis.R#L5 #' @param desandbox_object A SummarizedE ...
R/de_analysis.R#L7 #' @param covariates Character vector of ...
R/de_analysis.R#L8 #' @param contrast A character vector sp ...
R/de_analysis.R#L42       design_formula <- as.formula(paste ...
R/de_analysis.R#L60     dds <- DESeq2::DESeq(dds, parallel = ...
R/de_analysis.R#L71     res <- DESeq2::results(dds, contrast ...
R/de_analysis.R#L79   res_df <- res_df[, c("gene", "baseMean ...
R/de_analysis.R#L101 #' Performs differential expression anal ...
R/de_analysis.R#L103 #' @param desandbox_object A SummarizedE ...
R/de_analysis.R#L105 #' @param covariates Character vector of ...
R/de_analysis.R#L106 #' @param contrast A numeric contrast ve ...
R/de_analysis.R#L107 #' @param normalization Normalization me ...
R/de_analysis.R#L114 #' @importFrom edgeR DGEList calcNormFac ...
R/de_analysis.R#L138       design_formula <- as.formula(paste ...
R/de_analysis.R#L214 #' @param desandbox_object A SummarizedE ...
R/de_analysis.R#L216 #' @param covariates Character vector of ...
R/de_analysis.R#L217 #' @param contrast A numeric contrast ve ...
R/de_analysis.R#L218 #' @param normalization Normalization me ...
R/de_analysis.R#L252       design_formula <- as.formula(paste ...
R/de_analysis.R#L326 #' @param desandbox_object A SummarizedE ...
R/de_analysis.R#L327 #' @param methods Vector of methods to r ...
R/enrichment.R#L6 #' @param gene_id_type Type of gene IDs: ...
R/enrichment.R#L8 #' @param analysis_type Type of enrichme ...
R/enrichment.R#L132       message(sprintf("Found %d signific ...
R/enrichment.R#L163       message(sprintf("Found %d signific ...
R/enrichment.R#L191 #' @param use_lfc Whether to use log2FC  ...
R/enrichment.R#L221   message(sprintf("Running enrichment on ...
R/result_processing.R#L5 #' @param de_result A result object from ...
R/result_processing.R#L30     stop(sprintf("Missing required colum ...
R/result_processing.R#L36     baseMean = if ("baseMean" %in% colna ...
R/result_processing.R#L128 #' @param include_metadata Whether to in ...
R/result_processing.R#L160             if (!is.null(params$design_f ...
R/result_processing.R#L176         json_str <- jsonlite::toJSON(exp ...
R/result_processing.R#L228           if (!is.null(params$design_for ...
R/result_processing.R#L242         json_str <- jsonlite::toJSON(exp ...
R/visualization.R#L177 #' @param log2FC_threshold Log2 fold cha ...
R/visualization.R#L178 #' @param padj_threshold Adjusted p-valu ...
R/visualization.R#L179 #' @param facet_by_method If TRUE and me ...
R/visualization.R#L180 #' @param label_top_n Number of top sign ...
R/visualization.R#L181 #' @param label_by Criteria for selectin ...
R/visualization.R#L234   if (!"gene_id" %in% colnames(results_d ...
R/visualization.R#L250   plot_df$neg_log10_padj[is.infinite(plo ...
R/visualization.R#L342       panel.grid.major = ggplot2::elemen ...
R/visualization.R#L352       plot.subtitle = ggplot2::element_t ...
R/visualization.R#L355       strip.background = ggplot2::elemen ...
R/visualization.R#L388     "Significance criteria: |log2FC| > % ...
R/visualization.R#L398       plot.caption = ggplot2::element_te ...
R/visualization.R#L412 #' @param log2FC_threshold Log2 fold cha ...
R/visualization.R#L413 #' @param padj_threshold Adjusted p-valu ...
R/visualization.R#L414 #' @param direction Direction to filter: ...
R/visualization.R#L416 #' @param methods Vector of method names ...
R/visualization.R#L419 #' @param return_type Return "plot" for  ...
R/visualization.R#L489     colors <- c("#D62728", "#1F77B4", "# ...
R/visualization.R#L497     p <- create_venn_2way(venn_data, col ...
R/visualization.R#L499     p <- create_venn_3way(venn_data, col ...
R/visualization.R#L620     ggplot2::scale_fill_manual(values =  ...
R/visualization.R#L632       subtitle = sprintf("Significance:  ...
R/visualization.R#L634                         format(venn_data ...
R/visualization.R#L637                        round(100 * venn_ ...
R/visualization.R#L641       plot.subtitle = ggplot2::element_t ...
R/visualization.R#L642       plot.caption = ggplot2::element_te ...
R/visualization.R#L743     ggplot2::scale_fill_manual(values =  ...
R/visualization.R#L755       subtitle = sprintf("Significance:  ...
R/visualization.R#L764       plot.subtitle = ggplot2::element_t ...
R/visualization.R#L765       plot.caption = ggplot2::element_te ...
R/visualization.R#L776 #' Generates a bar plot comparing the nu ...
R/visualization.R#L782 #' @param split_by_direction If TRUE, sp ...
vignettes/getting_started.Rmd#L47 We'll use the airway dataset from Biocon ...
* NOTE: Consider multiples of 4 spaces for line indents; 1402 lines (44%) are not.
First few lines:
R/caching.R#L18                           cache_dir = ". ...
R/caching.R#L19                           cache_name = N ...
R/caching.R#L20                           metadata = NUL ...
R/caching.R#L21    ...
R/caching.R#L22   # Create cache directory if it doesn't ...
R/caching.R#L23   if (!dir.exists(cache_dir)) { ...
R/caching.R#L26   } ...
R/caching.R#L27    ...
R/caching.R#L28   # Generate cache name if not provided ...
R/caching.R#L29   if (is.null(cache_name)) { ...
R/caching.R#L34   } ...
R/caching.R#L35    ...
R/caching.R#L36   # Add .rds extension if not present ...
R/caching.R#L37   if (!grepl("\\.rds$", cache_name)) { ...
R/caching.R#L39   } ...
R/caching.R#L40    ...
R/caching.R#L41   cache_path <- file.path(cache_dir, cac ...
R/caching.R#L42    ...
R/caching.R#L43   # Prepare cache object ...
R/caching.R#L44   cache_object <- list( ...
R/caching.R#L47       cached_date = Sys.time(), ...
R/caching.R#L48       desandbox_version = tryCatch( ...
R/caching.R#L51       ), ...
R/caching.R#L52       r_version = R.version.string, ...
R/caching.R#L53       user_metadata = metadata ...
R/caching.R#L55   ) ...
R/caching.R#L56    ...
R/caching.R#L57   # Save to file ...
R/caching.R#L58   saveRDS(cache_object, cache_path) ...
R/caching.R#L59   message(sprintf("Results cached to: %s ...
R/caching.R#L60    ...
R/caching.R#L61   return(invisible(cache_path)) ...
R/caching.R#L78    ...
R/caching.R#L79   if (!file.exists(cache_path)) { ...
R/caching.R#L81   } ...
R/caching.R#L82    ...
R/caching.R#L83   message(sprintf("Loading cache from: % ...
R/caching.R#L84   cache_object <- readRDS(cache_path) ...
R/caching.R#L85    ...
R/caching.R#L86   # Check structure ...
R/caching.R#L87   if (!is.list(cache_object) || !"result ...
R/caching.R#L90   } ...
R/caching.R#L91    ...
R/caching.R#L92   # Display metadata ...
R/caching.R#L93   if ("cache_metadata" %in% names(cache_ ...
R/caching.R#L99       current_version <- tryCatch( ...
R/caching.R#L102       ) ...
R/caching.R#L103        ...
R/caching.R#L104       if (current_version != meta$desand ...
R/caching.R#L105           meta$desandbox_version != "unk ...
R/caching.R#L107           "Cache was created with DESand ...
R/caching.R#L108           meta$desandbox_version, curren ...
R/caching.R#L110       } ...
R/caching.R#L112   } ...
R/caching.R#L113    ...
R/caching.R#L114   return(cache_object$results) ...
R/caching.R#L130    ...
R/caching.R#L131   if (!dir.exists(cache_dir)) { ...
R/caching.R#L134   } ...
R/caching.R#L135    ...
R/caching.R#L136   cache_files <- list.files(cache_dir, p ...
R/caching.R#L137    ...
R/caching.R#L138   if (length(cache_files) == 0) { ...
R/caching.R#L141   } ...
R/caching.R#L142    ...
R/caching.R#L143   # Get file info ...
R/caching.R#L144   file_info <- file.info(cache_files) ...
R/caching.R#L145    ...
R/caching.R#L146   cache_info <- data.frame( ...
R/caching.R#L152   ) ...
R/caching.R#L153    ...
R/caching.R#L154   cache_info <- cache_info[order(cache_i ...
R/caching.R#L155    ...
R/caching.R#L156   return(cache_info) ...
R/caching.R#L175                        older_than = NULL ...
R/caching.R#L176                        confirm = TRUE) { ...
R/caching.R#L177    ...
R/caching.R#L178   if (!dir.exists(cache_dir)) { ...
R/caching.R#L181   } ...
R/caching.R#L182    ...
R/caching.R#L183   cache_files <- list.files(cache_dir, p ...
R/caching.R#L184    ...
R/caching.R#L185   if (length(cache_files) == 0) { ...
R/caching.R#L188   } ...
R/caching.R#L189    ...
R/caching.R#L190   # Filter by age if specified ...
R/caching.R#L191   if (!is.null(older_than)) { ...
R/caching.R#L197       message(sprintf("No cache files ol ...
R/caching.R#L198       return(0) ...
R/caching.R#L200   } ...
R/caching.R#L201    ...
R/caching.R#L202   # Confirm deletion ...
R/caching.R#L203   if (confirm) { ...
R/caching.R#L205       "Remove %d cache file(s)? (yes/no) ...
R/caching.R#L209       message("Operation cancelled") ...
R/caching.R#L210       return(0) ...
R/caching.R#L212   } ...
R/caching.R#L213    ...
R/caching.R#L214   # Remove files ...
R/caching.R#L215   n_removed <- sum(file.remove(cache_fil ...
R/caching.R#L216   message(sprintf("Removed %d cache file ...
R/caching.R#L217    ...
R/caching.R#L218   return(n_removed) ...
R/caching.R#L237    ...
R/caching.R#L238   # Extract key information ...
R/caching.R#L239   hash_components <- list( ...
R/caching.R#L244   ) ...
R/caching.R#L245    ...
R/caching.R#L246   analysis_hash <- digest::digest(hash_c ...
R/caching.R#L247    ...
R/caching.R#L248   return(analysis_hash) ...
R/comparison.R#L15                            padj_threshol ...
R/comparison.R#L16                            lfc_threshold ...
R/comparison.R#L17    ...
R/comparison.R#L18   if (!is.list(results_list) || length(r ...
R/comparison.R#L20   } ...
R/comparison.R#L21    ...
R/comparison.R#L22   method_names <- names(results_list) ...
R/comparison.R#L23   if (is.null(method_names)) { ...
R/comparison.R#L26   } ...
R/comparison.R#L27    ...
R/comparison.R#L28   # Extract and filter significant genes ...
R/comparison.R#L29   sig_genes_list <- list() ...
R/comparison.R#L30   all_results <- list() ...
R/comparison.R#L31    ...
R/comparison.R#L32   for (method in method_names) { ...
R/comparison.R#L38       res_df, ...
R/comparison.R#L39       padj_threshold = padj_threshold, ...
R/comparison.R#L40       lfc_threshold = lfc_threshold, ...
R/comparison.R#L41       direction = "both" ...
R/comparison.R#L46   } ...
R/comparison.R#L47    ...
R/comparison.R#L48   # Compute overlap statistics ...
R/comparison.R#L49   n_methods <- length(method_names) ...
R/comparison.R#L50   comparison_matrix <- matrix(0, nrow =  ...
R/comparison.R#L51                              dimnames =  ...
R/comparison.R#L52    ...
R/comparison.R#L53   for (i in 1:n_methods) { ...
R/comparison.R#L55       if (i <= j) { ...
R/comparison.R#L59       } ...
R/comparison.R#L61   } ...
R/comparison.R#L62    ...
R/comparison.R#L63   # Calculate Jaccard index for each pai ...
R/comparison.R#L64   jaccard_matrix <- matrix(0, nrow = n_m ...
R/comparison.R#L65                           dimnames = lis ...
R/comparison.R#L66    ...
R/comparison.R#L67   for (i in 1:n_methods) { ...
R/comparison.R#L69       if (i < j) { ...
R/comparison.R#L75       } else if (i == j) { ...
R/comparison.R#L77       } ...
R/comparison.R#L79   } ...
R/comparison.R#L80    ...
R/comparison.R#L81   # Count genes found by different numbe ...
R/comparison.R#L82   all_genes <- unique(unlist(sig_genes_l ...
R/comparison.R#L83   genes_by_method_count <- sapply(all_ge ...
R/comparison.R#L85   }) ...
R/comparison.R#L86    ...
R/comparison.R#L87   method_count_table <- table(genes_by_m ...
R/comparison.R#L88    ...
R/comparison.R#L89   # Create summary statistics ...
R/comparison.R#L90   summary_stats <- data.frame( ...
R/comparison.R#L94       res_df <- all_results[[m]] ...
R/comparison.R#L95       sig_genes <- sig_genes_list[[m]] ...
R/comparison.R#L96       sum(res_df$gene %in% sig_genes & r ...
R/comparison.R#L99       res_df <- all_results[[m]] ...
R/comparison.R#L100       sig_genes <- sig_genes_list[[m]] ...
R/comparison.R#L101       sum(res_df$gene %in% sig_genes & r ...
R/comparison.R#L104   ) ...
R/comparison.R#L105    ...
R/comparison.R#L106   # Find consensus genes (found by all m ...
R/comparison.R#L107   consensus_genes <- Reduce(intersect, s ...
R/comparison.R#L108    ...
R/comparison.R#L109   # Find method-specific genes (unique t ...
R/comparison.R#L110   method_specific <- lapply(method_names ...
R/comparison.R#L114   }) ...
R/comparison.R#L115   names(method_specific) <- method_names ...
R/comparison.R#L116    ...
R/comparison.R#L117   return(list( ...
R/comparison.R#L126       padj_threshold = padj_threshold, ...
R/comparison.R#L127       lfc_threshold = lfc_threshold ...
R/comparison.R#L129   )) ...
R/comparison.R#L148                            padj_threshol ...
R/comparison.R#L149                            lfc_threshold ...
R/comparison.R#L150                            direction = " ...
R/comparison.R#L151    ...
R/comparison.R#L152   if (!is.list(results_list)) { ...
R/comparison.R#L154   } ...
R/comparison.R#L155    ...
R/comparison.R#L156   method_names <- names(results_list) ...
R/comparison.R#L157   if (is.null(method_names)) { ...
R/comparison.R#L160   } ...
R/comparison.R#L161    ...
R/comparison.R#L162   # Extract significant genes for each m ...
R/comparison.R#L163   sig_genes_list <- list() ...
R/comparison.R#L164    ...
R/comparison.R#L165   for (method in method_names) { ...
R/comparison.R#L171       res_df, ...
R/comparison.R#L172       padj_threshold = padj_threshold, ...
R/comparison.R#L173       lfc_threshold = lfc_threshold, ...
R/comparison.R#L174       direction = direction ...
R/comparison.R#L178   } ...
R/comparison.R#L179    ...
R/comparison.R#L180   # Calculate all pairwise overlaps ...
R/comparison.R#L181   n_methods <- length(method_names) ...
R/comparison.R#L182   pairwise_overlaps <- list() ...
R/comparison.R#L183    ...
R/comparison.R#L184   for (i in 1:(n_methods - 1)) { ...
R/comparison.R#L186       method1 <- method_names[i] ...
R/comparison.R#L187       method2 <- method_names[j] ...
R/comparison.R#L188        ...
R/comparison.R#L189       overlap_genes <- intersect(sig_gen ...
R/comparison.R#L190       unique_to_1 <- setdiff(sig_genes_l ...
R/comparison.R#L191       unique_to_2 <- setdiff(sig_genes_l ...
R/comparison.R#L192        ...
R/comparison.R#L193       pair_name <- paste(method1, method ...
R/comparison.R#L194       pairwise_overlaps[[pair_name]] <-  ...
R/comparison.R#L204                                          ...
R/comparison.R#L205       ) ...
R/comparison.R#L207   } ...
R/comparison.R#L208    ...
R/comparison.R#L209   # Calculate overlap for all methods co ...
R/comparison.R#L210   if (n_methods >= 2) { ...
R/comparison.R#L214       sum(sapply(sig_genes_list, functio ...
R/comparison.R#L218       all_genes[overlap_counts == k] ...
R/comparison.R#L221   } else { ...
R/comparison.R#L223   } ...
R/comparison.R#L224    ...
R/comparison.R#L225   # Create a summary data.frame for easy ...
R/comparison.R#L226   overlap_summary <- do.call(rbind, lapp ...
R/comparison.R#L229       comparison = pair_name, ...
R/comparison.R#L230       method1 = pair$method1, ...
R/comparison.R#L231       method2 = pair$method2, ...
R/comparison.R#L232       n_overlap = pair$n_overlap, ...
R/comparison.R#L233       n_unique_method1 = pair$n_unique_m ...
R/comparison.R#L234       n_unique_method2 = pair$n_unique_m ...
R/comparison.R#L235       jaccard_index = round(pair$jaccard ...
R/comparison.R#L236       stringsAsFactors = FALSE ...
R/comparison.R#L238   })) ...
R/comparison.R#L239    ...
R/comparison.R#L240   return(list( ...
R/comparison.R#L246       padj_threshold = padj_threshold, ...
R/comparison.R#L247       lfc_threshold = lfc_threshold, ...
R/comparison.R#L248       direction = direction ...
R/comparison.R#L250   )) ...
R/comparison.R#L270                                   min_me ...
R/comparison.R#L271                                   padj_t ...
R/comparison.R#L272                                   lfc_th ...
R/comparison.R#L273                                   aggreg ...
R/comparison.R#L274    ...
R/comparison.R#L275   method_names <- names(results_list) ...
R/comparison.R#L276    ...
R/comparison.R#L277   # Get significant genes from each meth ...
R/comparison.R#L278   sig_genes_list <- list() ...
R/comparison.R#L279   all_results_list <- list() ...
R/comparison.R#L280    ...
R/comparison.R#L281   for (method in method_names) { ...
R/comparison.R#L287       res_df, ...
R/comparison.R#L288       padj_threshold = padj_threshold, ...
R/comparison.R#L289       lfc_threshold = lfc_threshold ...
R/comparison.R#L293   } ...
R/comparison.R#L294    ...
R/comparison.R#L295   # Find all genes and count support ...
R/comparison.R#L296   all_genes <- unique(unlist(sig_genes_l ...
R/comparison.R#L297    ...
R/comparison.R#L298   consensus_data <- lapply(all_genes, fu ...
R/comparison.R#L308       res_df <- all_results_list[[method ...
R/comparison.R#L309       gene_row <- res_df[res_df$gene ==  ...
R/comparison.R#L310        ...
R/comparison.R#L311       if (nrow(gene_row) > 0 && gene %in ...
R/comparison.R#L315       } ...
R/comparison.R#L320       agg_lfc <- mean(lfc_values, na.rm  ...
R/comparison.R#L322       agg_lfc <- median(lfc_values, na.r ...
R/comparison.R#L324       agg_lfc <- min(abs(lfc_values), na ...
R/comparison.R#L326       agg_lfc <- max(abs(lfc_values), na ...
R/comparison.R#L328       agg_lfc <- median(lfc_values, na.r ...
R/comparison.R#L332       gene = gene, ...
R/comparison.R#L333       n_methods_support = n_support, ...
R/comparison.R#L334       log2FoldChange = agg_lfc, ...
R/comparison.R#L335       mean_padj = mean(padj_values, na.r ...
R/comparison.R#L336       min_padj = min(padj_values, na.rm  ...
R/comparison.R#L337       methods = paste(methods_found, col ...
R/comparison.R#L338       stringsAsFactors = FALSE ...
R/comparison.R#L340   }) ...
R/comparison.R#L341    ...
R/comparison.R#L342   consensus_df <- do.call(rbind, consens ...
R/comparison.R#L343    ...
R/comparison.R#L344   # Filter by minimum method support ...
R/comparison.R#L345   consensus_df <- consensus_df[consensus ...
R/comparison.R#L346    ...
R/comparison.R#L347   # Sort by support and then by p-value ...
R/comparison.R#L348   consensus_df <- consensus_df[order(-co ...
R/comparison.R#L349                                      con ...
R/comparison.R#L350    ...
R/comparison.R#L351   message(sprintf("Found %d consensus ge ...
R/comparison.R#L352                   nrow(consensus_df), mi ...
R/comparison.R#L353    ...
R/comparison.R#L354   return(consensus_df) ...
R/data_validation.R#L17                            min_counts =  ...
R/data_validation.R#L18                            min_samples = ...
R/data_validation.R#L19                            allow_negativ ...
R/data_validation.R#L20    ...
R/data_validation.R#L21   # Check if counts is a matrix or can b ...
R/data_validation.R#L22   if (!is.matrix(counts) && !is.data.fra ...
R/data_validation.R#L24   } ...
R/data_validation.R#L25    ...
R/data_validation.R#L26   # Convert to matrix if data.frame ...
R/data_validation.R#L27   if (is.data.frame(counts)) { ...
R/data_validation.R#L31   } ...
R/data_validation.R#L32    ...
R/data_validation.R#L33   # Check for numeric values ...
R/data_validation.R#L34   if (!is.numeric(counts)) { ...
R/data_validation.R#L36   } ...
R/data_validation.R#L37    ...
R/data_validation.R#L38   # Check for negative values ...
R/data_validation.R#L39   if (!allow_negative && any(counts < 0, ...
R/data_validation.R#L41   } ...
R/data_validation.R#L42    ...
R/data_validation.R#L43   # Check for NA values ...
R/data_validation.R#L44   if (any(is.na(counts))) { ...
R/data_validation.R#L47   } ...
R/data_validation.R#L48    ...
R/data_validation.R#L49   # Check for non-integer values (warnin ...
R/data_validation.R#L50   if (any(counts != floor(counts), na.rm ...
R/data_validation.R#L52   } ...
R/data_validation.R#L53    ...
R/data_validation.R#L54   # Filter low-count genes ...
R/data_validation.R#L55   gene_sums <- rowSums(counts) ...
R/data_validation.R#L56   expressed_samples <- rowSums(counts >  ...
R/data_validation.R#L57    ...
R/data_validation.R#L58   keep <- gene_sums >= min_counts & expr ...
R/data_validation.R#L59    ...
R/data_validation.R#L60   n_filtered <- sum(!keep) ...
R/data_validation.R#L61   if (n_filtered > 0) { ...
R/data_validation.R#L63   } ...
R/data_validation.R#L64    ...
R/data_validation.R#L65   filtered_counts <- counts[keep, , drop ...
R/data_validation.R#L66    ...
R/data_validation.R#L67   # Check dimensions ...
R/data_validation.R#L68   if (nrow(filtered_counts) < 100) { ...
R/data_validation.R#L70   } ...
R/data_validation.R#L71    ...
R/data_validation.R#L72   if (ncol(filtered_counts) < 3) { ...
R/data_validation.R#L74   } ...
R/data_validation.R#L75    ...
R/data_validation.R#L76   return(list( ...
R/data_validation.R#L83       min_counts = min_counts, ...
R/data_validation.R#L84       min_samples = min_samples ...
R/data_validation.R#L86   )) ...
R/data_validation.R#L109                               counts = N ...
R/data_validation.R#L110                               condition_ ...
R/data_validation.R#L111                               required_c ...
R/data_validation.R#L112    ...
R/data_validation.R#L113   # Check if metadata is a data.frame ...
R/data_validation.R#L114   if (!is.data.frame(metadata)) { ...
R/data_validation.R#L116   } ...
R/data_validation.R#L117    ...
R/data_validation.R#L118   # Check if required columns exist ...
R/data_validation.R#L119   if (!is.null(required_columns)) { ...
R/data_validation.R#L122       stop(sprintf("Missing required col ...
R/data_validation.R#L123                    paste(missing_cols, c ...
R/data_validation.R#L125   } ...
R/data_validation.R#L126    ...
R/data_validation.R#L127   # Check if condition column exists ...
R/data_validation.R#L128   if (!condition_column %in% colnames(me ...
R/data_validation.R#L130   } ...
R/data_validation.R#L131    ...
R/data_validation.R#L132   # Convert condition to factor if not a ...
R/data_validation.R#L133   if (!is.factor(metadata[[condition_col ...
R/data_validation.R#L136   } ...
R/data_validation.R#L137    ...
R/data_validation.R#L138   # Check for at least 2 conditions ...
R/data_validation.R#L139   n_conditions <- nlevels(metadata[[cond ...
R/data_validation.R#L140   if (n_conditions < 2) { ...
R/data_validation.R#L142   } ...
R/data_validation.R#L143    ...
R/data_validation.R#L144   # Check for balanced design (warning o ...
R/data_validation.R#L145   condition_counts <- table(metadata[[co ...
R/data_validation.R#L146   if (any(condition_counts < 2)) { ...
R/data_validation.R#L148   } ...
R/data_validation.R#L149    ...
R/data_validation.R#L150   # Match with count matrix if provided ...
R/data_validation.R#L151   if (!is.null(counts)) { ...
R/data_validation.R#L154       if ("sample" %in% colnames(metadat ...
R/data_validation.R#L156       } else { ...
R/data_validation.R#L158       } ...
R/data_validation.R#L166       missing <- setdiff(count_samples,  ...
R/data_validation.R#L167       stop(sprintf("Count samples not in ...
R/data_validation.R#L168                    paste(missing, collap ...
R/data_validation.R#L172       extra <- setdiff(meta_samples, cou ...
R/data_validation.R#L173       warning(sprintf("Metadata samples  ...
R/data_validation.R#L174                       paste(extra, colla ...
R/data_validation.R#L179   } ...
R/data_validation.R#L180    ...
R/data_validation.R#L181   return(list( ...
R/data_validation.R#L188   )) ...
R/data_validation.R#L218                                    metad ...
R/data_validation.R#L219                                    condi ...
R/data_validation.R#L220                                    valid ...
R/data_validation.R#L221                                    ...)  ...
R/data_validation.R#L222    ...
R/data_validation.R#L223   if (validate) { ...
R/data_validation.R#L231   } ...
R/data_validation.R#L232    ...
R/data_validation.R#L233   # Create SummarizedExperiment object ...
R/data_validation.R#L234   se <- SummarizedExperiment::Summarized ...
R/data_validation.R#L237   ) ...
R/data_validation.R#L238    ...
R/data_validation.R#L239   # Add metadata about creation ...
R/data_validation.R#L240   S4Vectors::metadata(se)$condition_colu ...
R/data_validation.R#L241   S4Vectors::metadata(se)$creation_date  ...
R/data_validation.R#L242   S4Vectors::metadata(se)$desandbox_vers ...
R/data_validation.R#L245   ) ...
R/data_validation.R#L246    ...
R/data_validation.R#L247   return(se) ...
R/de_analysis.R#L24                        design_formula =  ...
R/de_analysis.R#L25                        covariates = NULL ...
R/de_analysis.R#L26                        contrast = NULL, ...
R/de_analysis.R#L27                        alpha = 0.05, ...
R/de_analysis.R#L28                        lfc_threshold = 0 ...
R/de_analysis.R#L29                        parallel = FALSE, ...
R/de_analysis.R#L30                        ...) { ...
R/de_analysis.R#L31    ...
R/de_analysis.R#L32   # Extract data from SummarizedExperime ...
R/de_analysis.R#L33   counts <- SummarizedExperiment::assay( ...
R/de_analysis.R#L34   coldata <- as.data.frame(SummarizedExp ...
R/de_analysis.R#L35   condition_col <- S4Vectors::metadata(d ...
R/de_analysis.R#L36    ...
R/de_analysis.R#L37   # Set up design formula ...
R/de_analysis.R#L38   if (is.null(design_formula)) { ...
R/de_analysis.R#L40       # Include covariates in design ...
R/de_analysis.R#L41       formula_terms <- c(covariates, con ...
R/de_analysis.R#L42       design_formula <- as.formula(paste ...
R/de_analysis.R#L43       message(sprintf("Using design form ...
R/de_analysis.R#L45       design_formula <- as.formula(paste ...
R/de_analysis.R#L47   } ...
R/de_analysis.R#L48    ...
R/de_analysis.R#L49   # Create DESeq2 object ...
R/de_analysis.R#L50   message("Creating DESeqDataSet...") ...
R/de_analysis.R#L51   dds <- DESeq2::DESeqDataSetFromMatrix( ...
R/de_analysis.R#L55   ) ...
R/de_analysis.R#L56    ...
R/de_analysis.R#L57   # Run DESeq2 ...
R/de_analysis.R#L58   message("Running DESeq2 analysis...") ...
R/de_analysis.R#L59   if (parallel) { ...
R/de_analysis.R#L61   } else { ...
R/de_analysis.R#L63   } ...
R/de_analysis.R#L64    ...
R/de_analysis.R#L65   # Extract results ...
R/de_analysis.R#L66   message("Extracting results...") ...
R/de_analysis.R#L67   if (is.null(contrast)) { ...
R/de_analysis.R#L70   } else { ...
R/de_analysis.R#L72   } ...
R/de_analysis.R#L73    ...
R/de_analysis.R#L74   # Convert to data.frame ...
R/de_analysis.R#L75   res_df <- as.data.frame(res) ...
R/de_analysis.R#L76   res_df$gene <- rownames(res_df) ...
R/de_analysis.R#L77    ...
R/de_analysis.R#L78   # Reorder columns ...
R/de_analysis.R#L79   res_df <- res_df[, c("gene", "baseMean ...
R/de_analysis.R#L80    ...
R/de_analysis.R#L81   # Return structured results ...
R/de_analysis.R#L82   return(list( ...
R/de_analysis.R#L88       design_formula = design_formula, ...
R/de_analysis.R#L89       covariates = covariates, ...
R/de_analysis.R#L90       contrast = contrast, ...
R/de_analysis.R#L91       alpha = alpha, ...
R/de_analysis.R#L92       lfc_threshold = lfc_threshold ...
R/de_analysis.R#L95   )) ...
R/de_analysis.R#L121                       design_formula = N ...
R/de_analysis.R#L122                       covariates = NULL, ...
R/de_analysis.R#L123                       contrast = NULL, ...
R/de_analysis.R#L124                       normalization = "T ...
R/de_analysis.R#L125                       robust = TRUE, ...
R/de_analysis.R#L126                       ...) { ...
R/de_analysis.R#L127    ...
R/de_analysis.R#L128   # Extract data from SummarizedExperime ...
R/de_analysis.R#L129   counts <- SummarizedExperiment::assay( ...
R/de_analysis.R#L130   coldata <- as.data.frame(SummarizedExp ...
R/de_analysis.R#L131   condition_col <- S4Vectors::metadata(d ...
R/de_analysis.R#L132    ...
R/de_analysis.R#L133   # Set up design formula ...
R/de_analysis.R#L134   if (is.null(design_formula)) { ...
R/de_analysis.R#L136       # Include covariates in design ...
R/de_analysis.R#L137       formula_terms <- c(covariates, con ...
R/de_analysis.R#L138       design_formula <- as.formula(paste ...
R/de_analysis.R#L139       message(sprintf("Using design form ...
R/de_analysis.R#L141       design_formula <- as.formula(paste ...
R/de_analysis.R#L143   } ...
R/de_analysis.R#L144    ...
R/de_analysis.R#L145   # Create design matrix ...
R/de_analysis.R#L146   design <- stats::model.matrix(design_f ...
R/de_analysis.R#L147    ...
R/de_analysis.R#L148   # Create DGEList object ...
R/de_analysis.R#L149   message("Creating DGEList...") ...
R/de_analysis.R#L150   dge <- edgeR::DGEList(counts = counts) ...
R/de_analysis.R#L151    ...
R/de_analysis.R#L152   # Normalize ...
R/de_analysis.R#L153   message(sprintf("Normalizing with %s m ...
R/de_analysis.R#L154   dge <- edgeR::calcNormFactors(dge, met ...
R/de_analysis.R#L155    ...
R/de_analysis.R#L156   # Estimate dispersion ...
R/de_analysis.R#L157   message("Estimating dispersion...") ...
R/de_analysis.R#L158   dge <- edgeR::estimateDisp(dge, design ...
R/de_analysis.R#L159    ...
R/de_analysis.R#L160   # Fit GLM ...
R/de_analysis.R#L161   message("Fitting quasi-likelihood GLM. ...
R/de_analysis.R#L162   fit <- edgeR::glmQLFit(dge, design, ro ...
R/de_analysis.R#L163    ...
R/de_analysis.R#L164   # Perform test ...
R/de_analysis.R#L165   message("Performing QL F-test...") ...
R/de_analysis.R#L166   if (is.null(contrast)) { ...
R/de_analysis.R#L169   } else { ...
R/de_analysis.R#L171   } ...
R/de_analysis.R#L172    ...
R/de_analysis.R#L173   # Extract top tags (all genes) ...
R/de_analysis.R#L174   tt <- edgeR::topTags(qlf, n = Inf, sor ...
R/de_analysis.R#L175   res_df <- as.data.frame(tt) ...
R/de_analysis.R#L176    ...
R/de_analysis.R#L177   # Standardize column names ...
R/de_analysis.R#L178   colnames(res_df)[colnames(res_df) == " ...
R/de_analysis.R#L179   colnames(res_df)[colnames(res_df) == " ...
R/de_analysis.R#L180   colnames(res_df)[colnames(res_df) == " ...
R/de_analysis.R#L181   colnames(res_df)[colnames(res_df) == " ...
R/de_analysis.R#L182    ...
R/de_analysis.R#L183   # Add gene column ...
R/de_analysis.R#L184   res_df$gene <- rownames(res_df) ...
R/de_analysis.R#L185    ...
R/de_analysis.R#L186   # Reorder columns to match standard fo ...
R/de_analysis.R#L187   standard_cols <- c("gene", "baseMean", ...
R/de_analysis.R#L188   other_cols <- setdiff(colnames(res_df) ...
R/de_analysis.R#L189   res_df <- res_df[, c(standard_cols, ot ...
R/de_analysis.R#L190    ...
R/de_analysis.R#L191   # Return structured results ...
R/de_analysis.R#L192   return(list( ...
R/de_analysis.R#L199       design_formula = design_formula, ...
R/de_analysis.R#L200       covariates = covariates, ...
R/de_analysis.R#L201       contrast = contrast, ...
R/de_analysis.R#L202       normalization = normalization, ...
R/de_analysis.R#L203       robust = robust ...
R/de_analysis.R#L206   )) ...
R/de_analysis.R#L234                            design_formul ...
R/de_analysis.R#L235                            covariates =  ...
R/de_analysis.R#L236                            contrast = NU ...
R/de_analysis.R#L237                            normalization ...
R/de_analysis.R#L238                            plot = FALSE, ...
R/de_analysis.R#L239                            robust = FALS ...
R/de_analysis.R#L240                            ...) { ...
R/de_analysis.R#L241    ...
R/de_analysis.R#L242   # Extract data from SummarizedExperime ...
R/de_analysis.R#L243   counts <- SummarizedExperiment::assay( ...
R/de_analysis.R#L244   coldata <- as.data.frame(SummarizedExp ...
R/de_analysis.R#L245   condition_col <- S4Vectors::metadata(d ...
R/de_analysis.R#L246    ...
R/de_analysis.R#L247   # Set up design formula ...
R/de_analysis.R#L248   if (is.null(design_formula)) { ...
R/de_analysis.R#L250       # Include covariates in design ...
R/de_analysis.R#L251       formula_terms <- c(covariates, con ...
R/de_analysis.R#L252       design_formula <- as.formula(paste ...
R/de_analysis.R#L253       message(sprintf("Using design form ...
R/de_analysis.R#L255       design_formula <- as.formula(paste ...
R/de_analysis.R#L257   } ...
R/de_analysis.R#L258    ...
R/de_analysis.R#L259   # Create design matrix ...
R/de_analysis.R#L260   design <- stats::model.matrix(design_f ...
R/de_analysis.R#L261    ...
R/de_analysis.R#L262   # Create DGEList and normalize ...
R/de_analysis.R#L263   message("Creating DGEList and normaliz ...
R/de_analysis.R#L264   dge <- edgeR::DGEList(counts = counts) ...
R/de_analysis.R#L265   dge <- edgeR::calcNormFactors(dge, met ...
R/de_analysis.R#L266    ...
R/de_analysis.R#L267   # Apply voom transformation ...
R/de_analysis.R#L268   message("Applying voom transformation. ...
R/de_analysis.R#L269   v <- limma::voom(dge, design, plot = p ...
R/de_analysis.R#L270    ...
R/de_analysis.R#L271   # Fit linear model ...
R/de_analysis.R#L272   message("Fitting linear model...") ...
R/de_analysis.R#L273   fit <- limma::lmFit(v, design) ...
R/de_analysis.R#L274    ...
R/de_analysis.R#L275   # Apply empirical Bayes ...
R/de_analysis.R#L276   message("Applying empirical Bayes mode ...
R/de_analysis.R#L277   fit <- limma::eBayes(fit, robust = rob ...
R/de_analysis.R#L278    ...
R/de_analysis.R#L279   # Extract results ...
R/de_analysis.R#L280   message("Extracting results...") ...
R/de_analysis.R#L281   if (is.null(contrast)) { ...
R/de_analysis.R#L284   } else { ...
R/de_analysis.R#L286   } ...
R/de_analysis.R#L287    ...
R/de_analysis.R#L288   # Standardize column names ...
R/de_analysis.R#L289   res_df <- as.data.frame(tt) ...
R/de_analysis.R#L290   colnames(res_df)[colnames(res_df) == " ...
R/de_analysis.R#L291   colnames(res_df)[colnames(res_df) == " ...
R/de_analysis.R#L292   colnames(res_df)[colnames(res_df) == " ...
R/de_analysis.R#L293   colnames(res_df)[colnames(res_df) == " ...
R/de_analysis.R#L294    ...
R/de_analysis.R#L295   # Add gene column ...
R/de_analysis.R#L296   res_df$gene <- rownames(res_df) ...
R/de_analysis.R#L297    ...
R/de_analysis.R#L298   # Reorder columns ...
R/de_analysis.R#L299   standard_cols <- c("gene", "baseMean", ...
R/de_analysis.R#L300   other_cols <- setdiff(colnames(res_df) ...
R/de_analysis.R#L301   res_df <- res_df[, c(standard_cols, ot ...
R/de_analysis.R#L302    ...
R/de_analysis.R#L303   # Return structured results ...
R/de_analysis.R#L304   return(list( ...
R/de_analysis.R#L311       design_formula = design_formula, ...
R/de_analysis.R#L312       covariates = covariates, ...
R/de_analysis.R#L313       contrast = contrast, ...
R/de_analysis.R#L314       normalization = normalization, ...
R/de_analysis.R#L315       robust = robust ...
R/de_analysis.R#L318   )) ...
R/de_analysis.R#L336                            methods = c(" ...
R/de_analysis.R#L337                            ...) { ...
R/de_analysis.R#L338    ...
R/de_analysis.R#L339   results <- list() ...
R/de_analysis.R#L340    ...
R/de_analysis.R#L341   if ("DESeq2" %in% methods) { ...
R/de_analysis.R#L344       run_deseq2(desandbox_object, ...) ...
R/de_analysis.R#L346       warning(sprintf("DESeq2 failed: %s ...
R/de_analysis.R#L347       NULL ...
R/de_analysis.R#L349   } ...
R/de_analysis.R#L350    ...
R/de_analysis.R#L351   if ("edgeR" %in% methods) { ...
R/de_analysis.R#L354       run_edger(desandbox_object, ...) ...
R/de_analysis.R#L356       warning(sprintf("edgeR failed: %s" ...
R/de_analysis.R#L357       NULL ...
R/de_analysis.R#L359   } ...
R/de_analysis.R#L360    ...
R/de_analysis.R#L361   if ("limma-voom" %in% methods) { ...
R/de_analysis.R#L364       run_limma_voom(desandbox_object, . ...
R/de_analysis.R#L366       warning(sprintf("limma-voom failed ...
R/de_analysis.R#L367       NULL ...
R/de_analysis.R#L369   } ...
R/de_analysis.R#L370    ...
R/de_analysis.R#L371   # Remove NULL entries (failed methods) ...
R/de_analysis.R#L372   results <- results[!sapply(results, is ...
R/de_analysis.R#L373    ...
R/de_analysis.R#L374   if (length(results) == 0) { ...
R/de_analysis.R#L376   } ...
R/de_analysis.R#L377    ...
R/de_analysis.R#L378   message(sprintf("\n=== Completed %d/%d ...
R/de_analysis.R#L379                   length(results), lengt ...
R/de_analysis.R#L380    ...
R/de_analysis.R#L381   return(results) ...
R/enrichment.R#L25                           gene_id_type = ...
R/enrichment.R#L26                           organism = "hu ...
R/enrichment.R#L27                           analysis_type  ...
R/enrichment.R#L28                           ontology = "BP ...
R/enrichment.R#L29                           pvalue_cutoff  ...
R/enrichment.R#L30                           qvalue_cutoff  ...
R/enrichment.R#L31                           background_gen ...
R/enrichment.R#L32                           min_gs_size =  ...
R/enrichment.R#L33                           max_gs_size =  ...
R/enrichment.R#L34    ...
R/enrichment.R#L35   # Select organism database ...
R/enrichment.R#L36   if (organism == "human") { ...
R/enrichment.R#L39   } else if (organism == "mouse") { ...
R/enrichment.R#L42   } else if (organism == "rat") { ...
R/enrichment.R#L45   } else { ...
R/enrichment.R#L47   } ...
R/enrichment.R#L48    ...
R/enrichment.R#L49   # Load organism database ...
R/enrichment.R#L50   if (!requireNamespace(orgdb, quietly = ...
R/enrichment.R#L52   } ...
R/enrichment.R#L53    ...
R/enrichment.R#L54   # Convert gene IDs to ENTREZ if needed ...
R/enrichment.R#L55   if (gene_id_type != "ENTREZID") { ...
R/enrichment.R#L61       get(orgdb), ...
R/enrichment.R#L62       keys = gene_names, ...
R/enrichment.R#L63       column = "ENTREZID", ...
R/enrichment.R#L64       keytype = gene_id_type, ...
R/enrichment.R#L65       multiVals = "first" ...
R/enrichment.R#L72       stop("No genes could be mapped to  ...
R/enrichment.R#L80       gene_list <- gene_list[names(entre ...
R/enrichment.R#L81       names(gene_list) <- as.character(e ...
R/enrichment.R#L83       gene_list <- as.character(entrez_i ...
R/enrichment.R#L85   } ...
R/enrichment.R#L86    ...
R/enrichment.R#L87   # Convert background genes if provided ...
R/enrichment.R#L88   if (!is.null(background_genes)) { ...
R/enrichment.R#L90       bg_entrez <- AnnotationDbi::mapIds ...
R/enrichment.R#L96       ) ...
R/enrichment.R#L97       background_genes <- as.character(b ...
R/enrichment.R#L99   } ...
R/enrichment.R#L100    ...
R/enrichment.R#L101   results <- list() ...
R/enrichment.R#L102    ...
R/enrichment.R#L103   # GO Enrichment ...
R/enrichment.R#L104   if (analysis_type %in% c("GO", "both") ...
R/enrichment.R#L108       clusterProfiler::enrichGO( ...
R/enrichment.R#L120       ) ...
R/enrichment.R#L122       warning(sprintf("GO enrichment fai ...
R/enrichment.R#L123       NULL ...
R/enrichment.R#L127       results$GO <- list( ...
R/enrichment.R#L131       ) ...
R/enrichment.R#L132       message(sprintf("Found %d signific ...
R/enrichment.R#L134   } ...
R/enrichment.R#L135    ...
R/enrichment.R#L136   # KEGG Enrichment ...
R/enrichment.R#L137   if (analysis_type %in% c("KEGG", "both ...
R/enrichment.R#L141       clusterProfiler::enrichKEGG( ...
R/enrichment.R#L151       ) ...
R/enrichment.R#L153       warning(sprintf("KEGG enrichment f ...
R/enrichment.R#L154       NULL ...
R/enrichment.R#L158       results$KEGG <- list( ...
R/enrichment.R#L162       ) ...
R/enrichment.R#L163       message(sprintf("Found %d signific ...
R/enrichment.R#L165   } ...
R/enrichment.R#L166    ...
R/enrichment.R#L167   # Add metadata ...
R/enrichment.R#L168   results$parameters <- list( ...
R/enrichment.R#L177   ) ...
R/enrichment.R#L178    ...
R/enrichment.R#L179   return(results) ...
R/enrichment.R#L200                                    padj_ ...
R/enrichment.R#L201                                    lfc_t ...
R/enrichment.R#L202                                    direc ...
R/enrichment.R#L203                                    use_l ...
R/enrichment.R#L204                                    ...)  ...
R/enrichment.R#L205    ...
R/enrichment.R#L206   # Extract data.frame if needed ...
R/enrichment.R#L207   res_df <- if (is.data.frame(de_results ...
R/enrichment.R#L208    ...
R/enrichment.R#L209   # Filter for significant genes ...
R/enrichment.R#L210   sig_genes <- filter_results( ...
R/enrichment.R#L215   ) ...
R/enrichment.R#L216    ...
R/enrichment.R#L217   if (nrow(sig_genes) == 0) { ...
R/enrichment.R#L219   } ...
R/enrichment.R#L220    ...
R/enrichment.R#L221   message(sprintf("Running enrichment on ...
R/enrichment.R#L222    ...
R/enrichment.R#L223   # Prepare gene list ...
R/enrichment.R#L224   if (use_lfc) { ...
R/enrichment.R#L229   } else { ...
R/enrichment.R#L232   } ...
R/enrichment.R#L233    ...
R/enrichment.R#L234   # Optionally use all genes as backgrou ...
R/enrichment.R#L235   background <- res_df$gene ...
R/enrichment.R#L236    ...
R/enrichment.R#L237   # Run enrichment ...
R/enrichment.R#L238   enrichment_results <- run_enrichment( ...
R/enrichment.R#L242   ) ...
R/enrichment.R#L243    ...
R/enrichment.R#L244   return(enrichment_results) ...
R/enrichment.R#L263                               padj_thres ...
R/enrichment.R#L264                               lfc_thresh ...
R/enrichment.R#L265                               ...) { ...
R/enrichment.R#L266    ...
R/enrichment.R#L267   method_names <- names(results_list) ...
R/enrichment.R#L268   enrichment_results <- list() ...
R/enrichment.R#L269    ...
R/enrichment.R#L270   # Run enrichment for each method ...
R/enrichment.R#L271   for (method in method_names) { ...
R/enrichment.R#L275       run_enrichment_from_de( ...
R/enrichment.R#L280       ) ...
R/enrichment.R#L282       warning(sprintf("Enrichment failed ...
R/enrichment.R#L283       NULL ...
R/enrichment.R#L285   } ...
R/enrichment.R#L286    ...
R/enrichment.R#L287   # Remove NULL entries ...
R/enrichment.R#L288   enrichment_results <- enrichment_resul ...
R/enrichment.R#L289    ...
R/enrichment.R#L290   # Find overlapping pathways ...
R/enrichment.R#L291   if (length(enrichment_results) >= 2) { ...
R/enrichment.R#L296       if (!is.null(x$GO)) { ...
R/enrichment.R#L298       } else { ...
R/enrichment.R#L300       } ...
R/enrichment.R#L305       if (!is.null(x$KEGG)) { ...
R/enrichment.R#L307       } else { ...
R/enrichment.R#L309       } ...
R/enrichment.R#L314       GO = if (all(sapply(go_terms, leng ...
R/enrichment.R#L316       } else NULL, ...
R/enrichment.R#L317       KEGG = if (all(sapply(kegg_pathway ...
R/enrichment.R#L319       } else NULL ...
R/enrichment.R#L323   } ...
R/enrichment.R#L324    ...
R/enrichment.R#L325   return(enrichment_results) ...
R/enrichment.R#L334    ...
R/enrichment.R#L335   method_names <- names(pathway_lists) ...
R/enrichment.R#L336   n_methods <- length(method_names) ...
R/enrichment.R#L337    ...
R/enrichment.R#L338   # Count occurrences ...
R/enrichment.R#L339   all_pathways <- unique(unlist(pathway_ ...
R/enrichment.R#L340    ...
R/enrichment.R#L341   overlap_counts <- sapply(all_pathways, ...
R/enrichment.R#L343   }) ...
R/enrichment.R#L344    ...
R/enrichment.R#L345   # Create summary ...
R/enrichment.R#L346   consensus_pathways <- all_pathways[ove ...
R/enrichment.R#L347    ...
R/enrichment.R#L348   overlap_table <- table(overlap_counts) ...
R/enrichment.R#L349    ...
R/enrichment.R#L350   return(list( ...
R/enrichment.R#L355   )) ...
R/result_processing.R#L14    ...
R/result_processing.R#L15   if (is.null(method)) { ...
R/result_processing.R#L17   } ...
R/result_processing.R#L18    ...
R/result_processing.R#L19   if (is.null(method)) { ...
R/result_processing.R#L21   } ...
R/result_processing.R#L22    ...
R/result_processing.R#L23   res_df <- de_result$results ...
R/result_processing.R#L24    ...
R/result_processing.R#L25   # Ensure required columns exist ...
R/result_processing.R#L26   required_cols <- c("gene", "log2FoldCh ...
R/result_processing.R#L27   missing_cols <- setdiff(required_cols, ...
R/result_processing.R#L28    ...
R/result_processing.R#L29   if (length(missing_cols) > 0) { ...
R/result_processing.R#L31   } ...
R/result_processing.R#L32    ...
R/result_processing.R#L33   # Create standardized result ...
R/result_processing.R#L34   standard_res <- data.frame( ...
R/result_processing.R#L40            if ("t" %in% colnames(res_df) ...
R/result_processing.R#L41            if ("F" %in% colnames(res_df) ...
R/result_processing.R#L46   ) ...
R/result_processing.R#L47    ...
R/result_processing.R#L48   # Remove rows with NA gene names ...
R/result_processing.R#L49   standard_res <- standard_res[!is.na(st ...
R/result_processing.R#L50    ...
R/result_processing.R#L51   # Sort by adjusted p-value ...
R/result_processing.R#L52   standard_res <- standard_res[order(sta ...
R/result_processing.R#L53    ...
R/result_processing.R#L54   return(standard_res) ...
R/result_processing.R#L74                           padj_threshold ...
R/result_processing.R#L75                           lfc_threshold  ...
R/result_processing.R#L76                           baseMean_thres ...
R/result_processing.R#L77                           direction = "b ...
R/result_processing.R#L78    ...
R/result_processing.R#L79   # Check required columns ...
R/result_processing.R#L80   if (!"padj" %in% colnames(results)) { ...
R/result_processing.R#L82   } ...
R/result_processing.R#L83    ...
R/result_processing.R#L84   if (!"log2FoldChange" %in% colnames(re ...
R/result_processing.R#L86   } ...
R/result_processing.R#L87    ...
R/result_processing.R#L88   # Apply filters ...
R/result_processing.R#L89   filtered <- results ...
R/result_processing.R#L90    ...
R/result_processing.R#L91   # Filter by adjusted p-value ...
R/result_processing.R#L92   filtered <- filtered[!is.na(filtered$p ...
R/result_processing.R#L93    ...
R/result_processing.R#L94   # Filter by log2 fold change ...
R/result_processing.R#L95   if (direction == "both") { ...
R/result_processing.R#L97                           abs(filtered$l ...
R/result_processing.R#L98   } else if (direction == "up") { ...
R/result_processing.R#L100                           filtered$log2F ...
R/result_processing.R#L101   } else if (direction == "down") { ...
R/result_processing.R#L103                           filtered$log2F ...
R/result_processing.R#L104   } else { ...
R/result_processing.R#L106   } ...
R/result_processing.R#L107    ...
R/result_processing.R#L108   # Filter by base mean if specified ...
R/result_processing.R#L109   if (!is.null(baseMean_threshold) && "b ...
R/result_processing.R#L111                           filtered$baseM ...
R/result_processing.R#L112   } ...
R/result_processing.R#L113    ...
R/result_processing.R#L114   message(sprintf("Filtered to %d signif ...
R/result_processing.R#L115                   nrow(filtered), nrow(r ...
R/result_processing.R#L116    ...
R/result_processing.R#L117   return(filtered) ...
R/result_processing.R#L139                           output_prefix, ...
R/result_processing.R#L140                           formats = c("c ...
R/result_processing.R#L141                           include_metada ...
R/result_processing.R#L142    ...
R/result_processing.R#L143   output_files <- character() ...
R/result_processing.R#L144    ...
R/result_processing.R#L145   # Handle list of results (multiple met ...
R/result_processing.R#L146   if (is.list(results) && !is.data.frame ...
R/result_processing.R#L149       if (format == "json") { ...
R/result_processing.R#L155           res <- results[[method]] ...
R/result_processing.R#L156            ...
R/result_processing.R#L157           if (include_metadata) { ...
R/result_processing.R#L161               params$design_formula <- d ...
R/result_processing.R#L165               method = method, ...
R/result_processing.R#L166               results = res$results, ...
R/result_processing.R#L167               parameters = params, ...
R/result_processing.R#L168               analysis_date = as.charact ...
R/result_processing.R#L170           } else { ...
R/result_processing.R#L172           } ...
R/result_processing.R#L181       } else if (format == "rds") { ...
R/result_processing.R#L188       } else { ...
R/result_processing.R#L191           res_df <- results[[method]]$re ...
R/result_processing.R#L192           safe_method <- gsub("-", "_",  ...
R/result_processing.R#L193           output_file <- paste0(output_p ...
R/result_processing.R#L194            ...
R/result_processing.R#L195           if (format == "csv") { ...
R/result_processing.R#L197                              row.names = ...
R/result_processing.R#L198           } else if (format == "tsv") { ...
R/result_processing.R#L200                              row.names = ...
R/result_processing.R#L201           } ...
R/result_processing.R#L202            ...
R/result_processing.R#L203           output_files <- c(output_files ...
R/result_processing.R#L204           message(sprintf("Exported %s r ...
R/result_processing.R#L206       } ...
R/result_processing.R#L209   } else { ...
R/result_processing.R#L214       output_file <- paste0(output_prefi ...
R/result_processing.R#L215        ...
R/result_processing.R#L216       if (format == "csv") { ...
R/result_processing.R#L218                          row.names = FAL ...
R/result_processing.R#L219       } else if (format == "tsv") { ...
R/result_processing.R#L221                          row.names = FAL ...
R/result_processing.R#L222       } else if (format == "json") { ...
R/result_processing.R#L224           list(results = res_df) ...
R/result_processing.R#L226           # Convert formula to string fo ...
R/result_processing.R#L227           params <- results$parameters ...
R/result_processing.R#L228           if (!is.null(params$design_for ...
R/result_processing.R#L230           } ...
R/result_processing.R#L231            ...
R/result_processing.R#L232           list( ...
R/result_processing.R#L237           ) ...
R/result_processing.R#L239           res_df ...
R/result_processing.R#L244       } else if (format == "rds") { ...
R/result_processing.R#L246       } ...
R/result_processing.R#L247        ...
R/result_processing.R#L248       output_files <- c(output_files, ou ...
R/result_processing.R#L249       message(sprintf("Exported to %s",  ...
R/result_processing.R#L251   } ...
R/result_processing.R#L252    ...
R/result_processing.R#L253   return(invisible(output_files)) ...
R/utils.R#L17   # Visualization variables (ggplot2 aes ...
R/utils.R#L18   "log2FC", ...
R/utils.R#L19   "neg_log10_padj", ...
R/utils.R#L20   "significance", ...
R/utils.R#L21   "label", ...
R/utils.R#L22   "x", ...
R/utils.R#L23   "y", ...
R/utils.R#L24   "set", ...
R/utils.R#L25   "size", ...
R/utils.R#L26   "Method", ...
R/utils.R#L27   "Freq", ...
R/utils.R#L28   "Direction" ...
R/visualization.R#L25                                   log2FC ...
R/visualization.R#L26                                   padj_t ...
R/visualization.R#L27    ...
R/visualization.R#L28   # Handle NA values ...
R/visualization.R#L29   sig_cat <- rep("Not significant", leng ...
R/visualization.R#L30    ...
R/visualization.R#L31   # Upregulated: log2FC > threshold AND  ...
R/visualization.R#L32   sig_cat[!is.na(log2FC) & !is.na(padj)  ...
R/visualization.R#L33           log2FC > log2FC_threshold &  ...
R/visualization.R#L34           padj < padj_threshold] <- "Upr ...
R/visualization.R#L35    ...
R/visualization.R#L36   # Downregulated: log2FC < -threshold A ...
R/visualization.R#L37   sig_cat[!is.na(log2FC) & !is.na(padj)  ...
R/visualization.R#L38           log2FC < -log2FC_threshold &  ...
R/visualization.R#L39           padj < padj_threshold] <- "Dow ...
R/visualization.R#L40    ...
R/visualization.R#L41   # Return as ordered factor for consist ...
R/visualization.R#L42   factor(sig_cat,  ...
R/visualization.R#L43          levels = c("Upregulated", "Down ...
R/visualization.R#L58    ...
R/visualization.R#L59   if (n <= 0 || nrow(results_df) == 0) { ...
R/visualization.R#L61   } ...
R/visualization.R#L62    ...
R/visualization.R#L63   # Remove rows with NA values ...
R/visualization.R#L64   clean_df <- results_df[!is.na(results_ ...
R/visualization.R#L65    ...
R/visualization.R#L66   if (nrow(clean_df) == 0) { ...
R/visualization.R#L68   } ...
R/visualization.R#L69    ...
R/visualization.R#L70   # Rank genes ...
R/visualization.R#L71   if (by == "padj") { ...
R/visualization.R#L74   } else if (by == "abs_log2FC") { ...
R/visualization.R#L77   } ...
R/visualization.R#L78    ...
R/visualization.R#L79   # Return top N gene IDs ...
R/visualization.R#L80   head(clean_df$gene_id, min(n, nrow(cle ...
R/visualization.R#L96                               log2FC_thr ...
R/visualization.R#L97                               padj_thres ...
R/visualization.R#L98                               direction  ...
R/visualization.R#L99    ...
R/visualization.R#L100   # Validate direction ...
R/visualization.R#L101   direction <- match.arg(direction, c("u ...
R/visualization.R#L102    ...
R/visualization.R#L103   # Get unique methods ...
R/visualization.R#L104   methods <- unique(results_df$method) ...
R/visualization.R#L105    ...
R/visualization.R#L106   # Initialize result list ...
R/visualization.R#L107   gene_sets <- list() ...
R/visualization.R#L108    ...
R/visualization.R#L109   for (method_name in methods) { ...
R/visualization.R#L115       sig_genes <- method_df$gene_id[ ...
R/visualization.R#L120       ] ...
R/visualization.R#L122       sig_genes <- method_df$gene_id[ ...
R/visualization.R#L127       ] ...
R/visualization.R#L129       sig_genes <- method_df$gene_id[ ...
R/visualization.R#L134       ] ...
R/visualization.R#L138   } ...
R/visualization.R#L139    ...
R/visualization.R#L140   return(gene_sets) ...
R/visualization.R#L153    ...
R/visualization.R#L154   if (!"significance" %in% colnames(resu ...
R/visualization.R#L156   } ...
R/visualization.R#L157    ...
R/visualization.R#L158   # Count genes in each category ...
R/visualization.R#L159   stats <- as.data.frame(table(results_d ...
R/visualization.R#L160   colnames(stats) <- c("Category", "Coun ...
R/visualization.R#L161    ...
R/visualization.R#L162   return(stats) ...
R/visualization.R#L223    ...
R/visualization.R#L224   # Input validation ...
R/visualization.R#L225   required_cols <- c("gene_id", "log2FC" ...
R/visualization.R#L226   missing_cols <- setdiff(required_cols, ...
R/visualization.R#L227    ...
R/visualization.R#L228   if (length(missing_cols) > 0) { ...
R/visualization.R#L231   } ...
R/visualization.R#L232    ...
R/visualization.R#L233   # Check for gene_id column (might be c ...
R/visualization.R#L234   if (!"gene_id" %in% colnames(results_d ...
R/visualization.R#L236   } ...
R/visualization.R#L237    ...
R/visualization.R#L238   # Remove rows with NA in critical colu ...
R/visualization.R#L239   plot_df <- results_df[!is.na(results_d ...
R/visualization.R#L240    ...
R/visualization.R#L241   if (nrow(plot_df) == 0) { ...
R/visualization.R#L243   } ...
R/visualization.R#L244    ...
R/visualization.R#L245   # Add -log10(padj) for y-axis ...
R/visualization.R#L246   plot_df$neg_log10_padj <- -log10(plot_ ...
R/visualization.R#L247    ...
R/visualization.R#L248   # Cap infinite values (padj = 0 cases) ...
R/visualization.R#L249   max_finite <- max(plot_df$neg_log10_pa ...
R/visualization.R#L250   plot_df$neg_log10_padj[is.infinite(plo ...
R/visualization.R#L251    ...
R/visualization.R#L252   # Classify significance ...
R/visualization.R#L253   plot_df$significance <- classify_signi ...
R/visualization.R#L258   ) ...
R/visualization.R#L259    ...
R/visualization.R#L260   # Define default colors if not provide ...
R/visualization.R#L261   if (is.null(colors)) { ...
R/visualization.R#L263       "Upregulated" = "#D62728",      #  ...
R/visualization.R#L264       "Downregulated" = "#1F77B4",    #  ...
R/visualization.R#L265       "Not significant" = "#D3D3D3"   #  ...
R/visualization.R#L267   } ...
R/visualization.R#L268    ...
R/visualization.R#L269   # Identify genes to label ...
R/visualization.R#L270   label_genes <- character(0) ...
R/visualization.R#L271   if (label_top_n > 0) { ...
R/visualization.R#L275       label_genes <- get_top_genes(sig_d ...
R/visualization.R#L277   } ...
R/visualization.R#L278    ...
R/visualization.R#L279   # Add label column ...
R/visualization.R#L280   plot_df$label <- "" ...
R/visualization.R#L281   plot_df$label[plot_df$gene_id %in% lab ...
R/visualization.R#L283    ...
R/visualization.R#L284   # Create base plot ...
R/visualization.R#L285   p <- ggplot2::ggplot(plot_df,  ...
R/visualization.R#L286                        ggplot2::aes(x =  ...
R/visualization.R#L287                                    y = n ...
R/visualization.R#L288                                    color ...
R/visualization.R#L294                        linetype = "dashe ...
R/visualization.R#L295                        color = "gray20", ...
R/visualization.R#L296                        linewidth = 0.6)  ...
R/visualization.R#L298                        linetype = "dashe ...
R/visualization.R#L299                        color = "gray20", ...
R/visualization.R#L300                        linewidth = 0.6)  ...
R/visualization.R#L304                      x = Inf,  ...
R/visualization.R#L305                      y = -log10(padj_thr ...
R/visualization.R#L306                      label = sprintf("pa ...
R/visualization.R#L307                      hjust = 1.1,  ...
R/visualization.R#L308                      vjust = -0.5,  ...
R/visualization.R#L309                      size = 3,  ...
R/visualization.R#L310                      color = "gray20", ...
R/visualization.R#L311                      fontface = "italic" ...
R/visualization.R#L313                      x = log2FC_threshol ...
R/visualization.R#L314                      y = Inf,  ...
R/visualization.R#L315                      label = sprintf("lo ...
R/visualization.R#L316                      hjust = 1.1,  ...
R/visualization.R#L317                      vjust = 1.2,  ...
R/visualization.R#L318                      size = 3,  ...
R/visualization.R#L319                      color = "gray20", ...
R/visualization.R#L320                      angle = 90, ...
R/visualization.R#L321                      fontface = "italic" ...
R/visualization.R#L323                      x = -log2FC_thresho ...
R/visualization.R#L324                      y = Inf,  ...
R/visualization.R#L325                      label = sprintf("lo ...
R/visualization.R#L326                      hjust = -0.1,  ...
R/visualization.R#L327                      vjust = 1.2,  ...
R/visualization.R#L328                      size = 3,  ...
R/visualization.R#L329                      color = "gray20", ...
R/visualization.R#L330                      angle = 90, ...
R/visualization.R#L331                      fontface = "italic" ...
R/visualization.R#L335       title = title, ...
R/visualization.R#L336       subtitle = subtitle, ...
R/visualization.R#L337       x = expression(log[2]~"fold change ...
R/visualization.R#L338       y = expression(-log[10]~"(adjusted ...
R/visualization.R#L342       panel.grid.major = ggplot2::elemen ...
R/visualization.R#L343       panel.grid.minor = ggplot2::elemen ...
R/visualization.R#L344       panel.border = ggplot2::element_re ...
R/visualization.R#L345       axis.line = ggplot2::element_line( ...
R/visualization.R#L346       legend.position = "top", ...
R/visualization.R#L347       legend.title = ggplot2::element_te ...
R/visualization.R#L348       legend.text = ggplot2::element_tex ...
R/visualization.R#L349       legend.background = ggplot2::eleme ...
R/visualization.R#L350       legend.key = ggplot2::element_rect ...
R/visualization.R#L351       plot.title = ggplot2::element_text ...
R/visualization.R#L352       plot.subtitle = ggplot2::element_t ...
R/visualization.R#L353       axis.title = ggplot2::element_text ...
R/visualization.R#L354       axis.text = ggplot2::element_text( ...
R/visualization.R#L355       strip.background = ggplot2::elemen ...
R/visualization.R#L356       strip.text = ggplot2::element_text ...
R/visualization.R#L358    ...
R/visualization.R#L359   # Add gene labels if requested ...
R/visualization.R#L360   if (label_top_n > 0 && length(label_ge ...
R/visualization.R#L364       data = label_df, ...
R/visualization.R#L365       ggplot2::aes(label = label), ...
R/visualization.R#L366       size = 3, ...
R/visualization.R#L367       max.overlaps = 20, ...
R/visualization.R#L368       box.padding = 0.5, ...
R/visualization.R#L369       point.padding = 0.3, ...
R/visualization.R#L370       segment.color = "gray50", ...
R/visualization.R#L371       segment.size = 0.3, ...
R/visualization.R#L372       show.legend = FALSE ...
R/visualization.R#L374   } ...
R/visualization.R#L375    ...
R/visualization.R#L376   # Add faceting if requested and method ...
R/visualization.R#L377   if (facet_by_method && "method" %in% c ...
R/visualization.R#L379   } ...
R/visualization.R#L380    ...
R/visualization.R#L381   # Add summary statistics as caption wi ...
R/visualization.R#L382   stats <- compute_volcano_stats(plot_df ...
R/visualization.R#L383   n_up <- stats$Count[stats$Category ==  ...
R/visualization.R#L384   n_down <- stats$Count[stats$Category = ...
R/visualization.R#L385   n_ns <- stats$Count[stats$Category ==  ...
R/visualization.R#L386    ...
R/visualization.R#L387   caption <- sprintf( ...
R/visualization.R#L394   ) ...
R/visualization.R#L395    ...
R/visualization.R#L396   p <- p + ggplot2::labs(caption = capti ...
R/visualization.R#L398       plot.caption = ggplot2::element_te ...
R/visualization.R#L400    ...
R/visualization.R#L401   return(p) ...
R/visualization.R#L448    ...
R/visualization.R#L449   # Input validation ...
R/visualization.R#L450   required_cols <- c("method", "gene_id" ...
R/visualization.R#L451   missing_cols <- setdiff(required_cols, ...
R/visualization.R#L452    ...
R/visualization.R#L453   if (length(missing_cols) > 0) { ...
R/visualization.R#L456   } ...
R/visualization.R#L457    ...
R/visualization.R#L458   # Filter methods if specified ...
R/visualization.R#L459   if (!is.null(methods)) { ...
R/visualization.R#L461   } ...
R/visualization.R#L462    ...
R/visualization.R#L463   # Extract gene sets ...
R/visualization.R#L464   gene_sets <- extract_gene_sets( ...
R/visualization.R#L469   ) ...
R/visualization.R#L470    ...
R/visualization.R#L471   if (length(gene_sets) == 0) { ...
R/visualization.R#L473   } ...
R/visualization.R#L474    ...
R/visualization.R#L475   # Return gene sets if requested ...
R/visualization.R#L476   if (return_type == "sets") { ...
R/visualization.R#L478   } ...
R/visualization.R#L479    ...
R/visualization.R#L480   # Create Venn diagram based on number  ...
R/visualization.R#L481   n_sets <- length(gene_sets) ...
R/visualization.R#L482    ...
R/visualization.R#L483   if (n_sets < 2 || n_sets > 3) { ...
R/visualization.R#L485   } ...
R/visualization.R#L486    ...
R/visualization.R#L487   # Define default colors ...
R/visualization.R#L488   if (is.null(colors)) { ...
R/visualization.R#L490   } ...
R/visualization.R#L491    ...
R/visualization.R#L492   # Calculate overlaps ...
R/visualization.R#L493   venn_data <- calculate_venn_overlaps(g ...
R/visualization.R#L494    ...
R/visualization.R#L495   # Create plot ...
R/visualization.R#L496   if (n_sets == 2) { ...
R/visualization.R#L498   } else { ...
R/visualization.R#L500   } ...
R/visualization.R#L501    ...
R/visualization.R#L502   return(p) ...
R/visualization.R#L515    ...
R/visualization.R#L516   set_names <- names(gene_sets) ...
R/visualization.R#L517   n_sets <- length(gene_sets) ...
R/visualization.R#L518    ...
R/visualization.R#L519   result <- list( ...
R/visualization.R#L522   ) ...
R/visualization.R#L523    ...
R/visualization.R#L524   if (n_sets == 2) { ...
R/visualization.R#L536   } else if (n_sets == 3) { ...
R/visualization.R#L564   } ...
R/visualization.R#L565    ...
R/visualization.R#L566   return(result) ...
R/visualization.R#L584                              log2FC_thre ...
R/visualization.R#L585    ...
R/visualization.R#L586   # Define circle positions and radius ...
R/visualization.R#L587   r <- 1.5 ...
R/visualization.R#L588   d <- 1.2  # Distance between centers ...
R/visualization.R#L589    ...
R/visualization.R#L590   circles <- data.frame( ...
R/visualization.R#L596   ) ...
R/visualization.R#L597    ...
R/visualization.R#L598   # Calculate label positions ...
R/visualization.R#L599   labels <- data.frame( ...
R/visualization.R#L603       sprintf("%s\n%d", venn_data$names[ ...
R/visualization.R#L604       sprintf("%s\n%d", venn_data$names[ ...
R/visualization.R#L605       sprintf("%d", venn_data$both) ...
R/visualization.R#L608   ) ...
R/visualization.R#L609    ...
R/visualization.R#L610   # Create plot ...
R/visualization.R#L611   p <- ggplot2::ggplot() + ...
R/visualization.R#L613       data = circles, ...
R/visualization.R#L614       ggplot2::aes(x0 = x, y0 = y, r = r ...
R/visualization.R#L615       alpha = 0.3, ...
R/visualization.R#L616       color = "black", ...
R/visualization.R#L617       linewidth = 0.8, ...
R/visualization.R#L618       show.legend = TRUE ...
R/visualization.R#L622       data = labels, ...
R/visualization.R#L623       ggplot2::aes(x = x, y = y, label = ...
R/visualization.R#L624       fontface = "bold", ...
R/visualization.R#L625       show.legend = FALSE ...
R/visualization.R#L631       title = title, ...
R/visualization.R#L632       subtitle = sprintf("Significance:  ...
R/visualization.R#L635       caption = sprintf("Overlap: %s gen ...
R/visualization.R#L636                        format(venn_data$ ...
R/visualization.R#L637                        round(100 * venn_ ...
R/visualization.R#L640       plot.title = ggplot2::element_text ...
R/visualization.R#L641       plot.subtitle = ggplot2::element_t ...
R/visualization.R#L642       plot.caption = ggplot2::element_te ...
R/visualization.R#L643       legend.position = "none", ...
R/visualization.R#L644       plot.margin = ggplot2::margin(10,  ...
R/visualization.R#L646    ...
R/visualization.R#L647   return(p) ...
R/visualization.R#L665                              log2FC_thre ...
R/visualization.R#L666    ...
R/visualization.R#L667   # Define circle positions for 3-way Ve ...
R/visualization.R#L668   r <- 1.5 ...
R/visualization.R#L669   angle_offset <- pi / 2  # Start at top ...
R/visualization.R#L670    ...
R/visualization.R#L671   circles <- data.frame( ...
R/visualization.R#L673       r * cos(angle_offset), ...
R/visualization.R#L674       r * cos(angle_offset + 2*pi/3), ...
R/visualization.R#L675       r * cos(angle_offset + 4*pi/3) ...
R/visualization.R#L678       r * sin(angle_offset), ...
R/visualization.R#L679       r * sin(angle_offset + 2*pi/3), ...
R/visualization.R#L680       r * sin(angle_offset + 4*pi/3) ...
R/visualization.R#L685   ) ...
R/visualization.R#L686    ...
R/visualization.R#L687   # Calculate label positions ...
R/visualization.R#L688   # Unique regions (outside overlaps) ...
R/visualization.R#L689   offset <- 1.8 ...
R/visualization.R#L690   labels <- data.frame( ...
R/visualization.R#L692       # Unique to each set ...
R/visualization.R#L693       offset * cos(angle_offset), ...
R/visualization.R#L694       offset * cos(angle_offset + 2*pi/3 ...
R/visualization.R#L695       offset * cos(angle_offset + 4*pi/3 ...
R/visualization.R#L696       # Pairwise overlaps ...
R/visualization.R#L697       0.6 * cos(angle_offset + pi/3), ...
R/visualization.R#L698       0.6 * cos(angle_offset + pi), ...
R/visualization.R#L699       0.6 * cos(angle_offset + 5*pi/3), ...
R/visualization.R#L700       # Three-way overlap (center) ...
R/visualization.R#L701       0 ...
R/visualization.R#L704       # Unique to each set ...
R/visualization.R#L705       offset * sin(angle_offset), ...
R/visualization.R#L706       offset * sin(angle_offset + 2*pi/3 ...
R/visualization.R#L707       offset * sin(angle_offset + 4*pi/3 ...
R/visualization.R#L708       # Pairwise overlaps ...
R/visualization.R#L709       0.6 * sin(angle_offset + pi/3), ...
R/visualization.R#L710       0.6 * sin(angle_offset + pi), ...
R/visualization.R#L711       0.6 * sin(angle_offset + 5*pi/3), ...
R/visualization.R#L712       # Three-way overlap (center) ...
R/visualization.R#L713       0 ...
R/visualization.R#L716       sprintf("%s\n%d", venn_data$names[ ...
R/visualization.R#L717       sprintf("%s\n%d", venn_data$names[ ...
R/visualization.R#L718       sprintf("%s\n%d", venn_data$names[ ...
R/visualization.R#L719       sprintf("%d", venn_data$AB_only), ...
R/visualization.R#L720       sprintf("%d", venn_data$AC_only), ...
R/visualization.R#L721       sprintf("%d", venn_data$BC_only), ...
R/visualization.R#L722       sprintf("%d", venn_data$ABC) ...
R/visualization.R#L726   ) ...
R/visualization.R#L727    ...
R/visualization.R#L728   # Total unique genes ...
R/visualization.R#L729   total_genes <- venn_data$only_A + venn ...
R/visualization.R#L732    ...
R/visualization.R#L733   # Create plot ...
R/visualization.R#L734   p <- ggplot2::ggplot() + ...
R/visualization.R#L736       data = circles, ...
R/visualization.R#L737       ggplot2::aes(x0 = x, y0 = y, r = r ...
R/visualization.R#L738       alpha = 0.3, ...
R/visualization.R#L739       color = "black", ...
R/visualization.R#L740       linewidth = 0.8, ...
R/visualization.R#L741       show.legend = TRUE ...
R/visualization.R#L745       data = labels, ...
R/visualization.R#L746       ggplot2::aes(x = x, y = y, label = ...
R/visualization.R#L747       fontface = labels$fontface, ...
R/visualization.R#L748       show.legend = FALSE ...
R/visualization.R#L754       title = title, ...
R/visualization.R#L755       subtitle = sprintf("Significance:  ...
R/visualization.R#L758       caption = sprintf("Three-way conse ...
R/visualization.R#L759                        format(venn_data$ ...
R/visualization.R#L760                        round(100 * venn_ ...
R/visualization.R#L763       plot.title = ggplot2::element_text ...
R/visualization.R#L764       plot.subtitle = ggplot2::element_t ...
R/visualization.R#L765       plot.caption = ggplot2::element_te ...
R/visualization.R#L766       legend.position = "none", ...
R/visualization.R#L767       plot.margin = ggplot2::margin(10,  ...
R/visualization.R#L769    ...
R/visualization.R#L770   return(p) ...
R/visualization.R#L793                           log2FC_thresho ...
R/visualization.R#L794                           padj_threshold ...
R/visualization.R#L795                           split_by_direc ...
R/visualization.R#L796    ...
R/visualization.R#L797   # Classify significance for each gene ...
R/visualization.R#L798   results_df$significance <- classify_si ...
R/visualization.R#L803   ) ...
R/visualization.R#L804    ...
R/visualization.R#L805   # Count by method and significance ...
R/visualization.R#L806   if (split_by_direction) { ...
R/visualization.R#L808       Method = results_df$method, ...
R/visualization.R#L809       Direction = results_df$significanc ...
R/visualization.R#L815       ggplot2::geom_bar(stat = "identity ...
R/visualization.R#L816       ggplot2::scale_fill_manual( ...
R/visualization.R#L818       ) + ...
R/visualization.R#L819       ggplot2::labs( ...
R/visualization.R#L823       ) ...
R/visualization.R#L824   } else { ...
R/visualization.R#L830       ggplot2::geom_bar(stat = "identity ...
R/visualization.R#L831       ggplot2::labs( ...
R/visualization.R#L835       ) ...
R/visualization.R#L836   } ...
R/visualization.R#L837    ...
R/visualization.R#L838   p <- p + ...
R/visualization.R#L841       plot.title = ggplot2::element_text ...
R/visualization.R#L842       panel.grid.major.x = ggplot2::elem ...
R/visualization.R#L844    ...
R/visualization.R#L845   return(p) ...
vignettes/getting_started.Rmd#L16   collapse = TRUE, ...
vignettes/getting_started.Rmd#L17   comment = "#>", ...
vignettes/getting_started.Rmd#L18   fig.width = 7, ...
vignettes/getting_started.Rmd#L19   fig.height = 5 ...
vignettes/getting_started.Rmd#L89   rnbinom(n_genes * n_samples, mu = 100, ...
vignettes/getting_started.Rmd#L90   nrow = n_genes, ...
vignettes/getting_started.Rmd#L91   ncol = n_samples ...
vignettes/getting_started.Rmd#L104   sample = colnames(counts), ...
vignettes/getting_started.Rmd#L105   condition = factor(rep(c("control", "t ...
vignettes/getting_started.Rmd#L106   batch = factor(rep(c("A", "B"), times  ...
vignettes/getting_started.Rmd#L123   counts, ...
vignettes/getting_started.Rmd#L124   min_counts = 10, ...
vignettes/getting_started.Rmd#L125   min_samples = 3 ...
vignettes/getting_started.Rmd#L131   metadata, ...
vignettes/getting_started.Rmd#L132   condition_column = "condition" ...
vignettes/getting_started.Rmd#L143   counts = counts, ...
vignettes/getting_started.Rmd#L144   metadata = metadata, ...
vignettes/getting_started.Rmd#L145   condition_column = "condition" ...
vignettes/getting_started.Rmd#L167   dso, ...
vignettes/getting_started.Rmd#L168   alpha = 0.05, ...
vignettes/getting_started.Rmd#L169   lfc_threshold = 0 ...
vignettes/getting_started.Rmd#L174   dso, ...
vignettes/getting_started.Rmd#L175   normalization = "TMM", ...
vignettes/getting_started.Rmd#L176   robust = TRUE ...
vignettes/getting_started.Rmd#L181   dso, ...
vignettes/getting_started.Rmd#L182   normalization = "TMM" ...
vignettes/getting_started.Rmd#L187   DESeq2 = deseq2_results, ...
vignettes/getting_started.Rmd#L188   edgeR = edger_results, ...
vignettes/getting_started.Rmd#L189   `limma-voom` = limma_results ...
vignettes/getting_started.Rmd#L198   DESeq2 = list( ...
vignettes/getting_started.Rmd#L201       gene = rownames(counts)[1:100], ...
vignettes/getting_started.Rmd#L202       baseMean = runif(100, 50, 500), ...
vignettes/getting_started.Rmd#L203       log2FoldChange = rnorm(100, 0, 2), ...
vignettes/getting_started.Rmd#L204       pvalue = runif(100, 0, 0.1), ...
vignettes/getting_started.Rmd#L205       padj = runif(100, 0, 0.1) ...
vignettes/getting_started.Rmd#L207   ) ...
vignettes/getting_started.Rmd#L216   results$DESeq2$results, ...
vignettes/getting_started.Rmd#L217   padj_threshold = 0.05, ...
vignettes/getting_started.Rmd#L218   lfc_threshold = 1, ...
vignettes/getting_started.Rmd#L219   direction = "both" ...
vignettes/getting_started.Rmd#L231   results, ...
vignettes/getting_started.Rmd#L232   padj_threshold = 0.05, ...
vignettes/getting_started.Rmd#L233   lfc_threshold = 1 ...
vignettes/getting_started.Rmd#L253   results, ...
vignettes/getting_started.Rmd#L254   padj_threshold = 0.05, ...
vignettes/getting_started.Rmd#L255   lfc_threshold = 1 ...
vignettes/getting_started.Rmd#L266   results, ...
vignettes/getting_started.Rmd#L267   min_methods = 2, ...
vignettes/getting_started.Rmd#L268   aggregate_lfc = "median" ...
vignettes/getting_started.Rmd#L281   results$DESeq2, ...
vignettes/getting_started.Rmd#L282   padj_threshold = 0.05, ...
vignettes/getting_started.Rmd#L283   lfc_threshold = 1, ...
vignettes/getting_started.Rmd#L284   gene_id_type = "SYMBOL", ...
vignettes/getting_started.Rmd#L285   organism = "human", ...
vignettes/getting_started.Rmd#L286   analysis_type = "both" ...
vignettes/getting_started.Rmd#L300   results, ...
vignettes/getting_started.Rmd#L301   organism = "human" ...
vignettes/getting_started.Rmd#L315   results, ...
vignettes/getting_started.Rmd#L316   output_prefix = "my_analysis", ...
vignettes/getting_started.Rmd#L317   formats = c("csv", "tsv", "json", "rds ...
vignettes/getting_started.Rmd#L326   results, ...
vignettes/getting_started.Rmd#L327   cache_dir = "./cache", ...
vignettes/getting_started.Rmd#L328   metadata = list( ...
vignettes/getting_started.Rmd#L332   ) ...
vignettes/getting_started.Rmd#L350   dso, ...
vignettes/getting_started.Rmd#L351   contrast = c("condition", "treatment", ...
vignettes/getting_started.Rmd#L362   dso, ...
vignettes/getting_started.Rmd#L363   parallel = TRUE ...
vignettes/getting_started.Rmd#L372   results$DESeq2$results, ...
vignettes/getting_started.Rmd#L373   direction = "up" ...
vignettes/getting_started.Rmd#L378   results$DESeq2$results, ...
vignettes/getting_started.Rmd#L379   direction = "down" ...
* Checking if package already exists in CRAN... OK
* Checking for bioc-devel mailing list subscription...
* NOTE: Cannot determine whether maintainer is subscribed to the Bioc-Devel mailing list (requires admin credentials). Subscribe here: https://stat.ethz.ch/mailman/listinfo/bioc-devel
* Checking for support site registration...
* ERROR: Unable to find your email in the Support Site:
  HTTP 404 Not Found.
